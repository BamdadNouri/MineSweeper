<html>

<table id="table">
<tr><td id="0-0">_</td><td id="0-1">_</td><td id="0-2">_</td><td id="0-3">_</td><td id="0-4">_</td><td id="0-5">_</td><td id="0-6">_</td><td id="0-7">_</td></tr>
<tr><td id="1-0">_</td><td id="1-1">_</td><td id="1-2">_</td><td id="1-3">_</td><td id="1-4">_</td><td id="1-5">_</td><td id="1-6">_</td><td id="1-7">_</td></tr>
<tr><td id="2-0">_</td><td id="2-1">_</td><td id="2-2">_</td><td id="2-3">_</td><td id="2-4">_</td><td id="2-5">_</td><td id="2-6">_</td><td id="2-7">_</td></tr>
<tr><td id="3-0">_</td><td id="3-1">_</td><td id="3-2">_</td><td id="3-3">_</td><td id="3-4">_</td><td id="3-5">_</td><td id="3-6">_</td><td id="3-7">_</td></tr>
<tr><td id="4-0">_</td><td id="4-1">_</td><td id="4-2">_</td><td id="4-3">_</td><td id="4-4">_</td><td id="4-5">_</td><td id="4-6">_</td><td id="4-7">_</td></tr>
<tr><td id="5-0">_</td><td id="5-1">_</td><td id="5-2">_</td><td id="5-3">_</td><td id="5-4">_</td><td id="5-5">_</td><td id="5-6">_</td><td id="5-7">_</td></tr>
<tr><td id="6-0">_</td><td id="6-1">_</td><td id="6-2">_</td><td id="6-3">_</td><td id="6-4">_</td><td id="6-5">_</td><td id="6-6">_</td><td id="6-7">_</td></tr>
<tr><td id="7-0">_</td><td id="7-1">_</td><td id="7-2">_</td><td id="7-3">_</td><td id="7-4">_</td><td id="7-5">_</td><td id="7-6">_</td><td id="7-7">_</td></tr>


</table>
</html>

<script>
var nonMineCount = 0
class Cell  {
    constructor(){
        this.isMine = false,
        this.isOpened = false,
        this.isFlaged = false,
        this.mineCount = 0

    }
}
var table = createTable()
console.log(table)
document.getElementById('table').style.backgroundColor = 'black'
document.getElementById('table').style.width = '220'
document.getElementById('table').style.height = '220px'
document.getElementById('table').addEventListener('click', function(e){


    if(e.shiftKey){
        flag(table, e.target.id.split('-')[0], e.target.id.split('-')[1])

    }else{
          if(table[parseInt(e.target.id.split('-')[0])][parseInt(e.target.id.split('-')[1])].isMine){
            alert('GAME OVER')
        }

        if(!table[parseInt(e.target.id.split('-')[0])][parseInt(e.target.id.split('-')[1])].isOpened){
            openCell(table, parseInt(e.target.id.split('-')[0]), parseInt(e.target.id.split('-')[1]))
        }
    }






        
})


function createTable(){

    var tbl = Array(8)
    for(var i=0; i<8; i++){
        tbl[i] = new Array(8)
    }

for(var i=0; i<8; i++){
    for(var j=0; j<8; j++){
        tbl[i][j] = new Cell
    }
}

return addMine(tbl)

}

function addMine(table){

    var mineC = 0

    while(mineC<9){
        var x = Math.floor(Math.random() * 8),
            y = Math.floor(Math.random() * 8)

        if(!table[x][y].isMine){

            table[x][y].isMine = true
            mineC++
        }
    }
    return table
}

function countNeighborMine(table, x, y){

    var mineC = 0

    for(var i=x-1; i<=x+1; i++){
        for(var j=y-1; j<=y+1; j++){
                if(i>=0 && j>=0 && i<8 && j<8){

                    if(table[i][j].isMine){
                    mineC++
                }
            }
        }
    }
    return mineC
}

function openCell(table, x, y){

    document.getElementById( x.toString() + '-' + y.toString()).style.backgroundColor = 'blue'
    table[x][y].isOpened = true
    document.getElementById( x.toString() + '-' + y.toString()).innerHTML = countNeighborMine(table, x, y)
    nonMineCount++
    if(!table[x][y].isMine && countNeighborMine(table, x, y) === 0){
        for(var i=x-1; i<=x+1; i++){
            for(var j=y-1; j<=y+1; j++){
                if(i>=0 && j>=0 && i<8 && j<8){

                    if(!table[i][j].isMine && !table[i][j].isOpened){
                        openCell(table, i, j)
                }
            }
        }
    }
    }
}

function flag(table, x, y){

    if(!table[x][y].isOpened){
    document.getElementById(x.toString() + '-' + y.toString()).style.backgroundColor = 'green'
    table[x][y].isFlaged = true
    }


}
</script>